
![Peek 2021-11-10 15-48](/img/oneko/Peek%202021-11-10%2015-48.gif)

## onekoä»‹ç»

æœ€è¿‘åœ¨aurä¸Šçœ‹åˆ°ä¸€ä¸ªæœ‰äº›æ—¶é—´äº†çš„æ¡Œå® é¡¹ç›®[Oneko](https://github.com/tie/oneko),ä¸‹è¿‡æ¥ç¼–è¯‘è¿è¡Œåä¼šæœ‰ä¸€ç›´å°çŒ«è¿½ç€ä½ çš„é¼ æ ‡è·‘,å¾ˆå¯çˆ±


é™¤äº†å°çŒ«ä»¥å¤–è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„è§’è‰²,è¿½å‡»æ¨¡å¼ä¹Ÿæœ‰å¾ˆå¤šç§,å¯ä»¥è®©ä¸€ç›´è·Ÿç€æˆ–è€…å‘†åœ¨çª—å£æœ€ä¸Šé¢,å…·ä½“ä½¿ç”¨è¯·æŸ¥é˜…æ‰‹å†Œ`man oneko`

å®‰è£…ä¹Ÿå¾ˆç®€å•,ç›´æ¥aurä¸Šå®‰è£…å°±è¡Œ`paru -S oneko`

## è°ƒæ•´å¤§å°
ä½†æ˜¯æœ‰ä¸ªå¤§é—®é¢˜,å°±æ˜¯å®ƒå¤ªå°äº†,å¯¹äºç°åœ¨åŠ¨ä¸åŠ¨å°±æ˜¯2k,4kçš„æ˜¾ç¤ºå™¨æ¥è¯´,é»˜è®¤çš„32x32pixeçš„å›¾ç‰‡å®åœ¨æ˜¯å¤ªå°äº†,æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•è®©å®ƒå˜å¾—æ›´å¤§ä¸€ç‚¹å‘¢,ä¸‹é¢åˆ†äº«ä¸€ä¸‹æˆ‘æŠ˜è…¾çš„è¿‡ç¨‹.

é¦–å…ˆæˆ‘ä»¬è¦è·å¾—è½¯ä»¶æºä»£ç ,å¯ä»¥ç›´æ¥å»å®˜ç½‘ä¸‹è½½,ä¿®æ”¹æºä»£ç åè¿›è¡Œç¼–è¯‘å®‰è£…. ä¸è¿‡makepkgæä¾›äº†ä¸€ä¸ªæ›´åŠ ç®€å•çš„æ–¹å¼,å¯ä»¥ç›´æ¥ä¿®æ”¹ç¼–è¯‘åå°†å…¶æ‰“åŒ…ä¸ºpacmançš„è½¯ä»¶åŒ….

### ç®€å•ä»‹ç»makepkgçš„ç”¨æ³•

makepkgæ˜¯Archç³»ç»Ÿçš„ä¸€ä¸ªå‘½ä»¤å·¥å…·,ç”¨äºè½¯ä»¶åŒ…è‡ªåŠ¨ç¼–è¯‘,è¿è¡Œæ—¶éœ€è¦æœ‰ä¸€ä¸ªPKGBUILDæ–‡ä»¶,PKGBUILDæœ¬è´¨æ˜¯ä¸€ä¸ªshellè„šæœ¬,è®°å½•è½¯ä»¶åŒ…çš„ä¸€äº›ä¿¡æ¯å’Œç¼–è¯‘æ­¥éª¤.
```shell
makepkg -Si #ç¼–è¯‘å¹¶å®‰è£…
makepkg -o #ä»…è§£å‹ç¼©æºä»£ç 
makepkg -e #ä»…ç¼–è¯‘å¹¶æ‰“åŒ…(ä¸è§£å‹å’Œä¸‹è½½æºä»£ç )
```

é‡åˆ°éœ€è¦ä¿®æ”¹æºä»£ç çš„è½¯ä»¶,æˆ‘ä¸€èˆ¬çš„æµç¨‹æ˜¯å…ˆè§£å‹,ä¿®æ”¹åç¼–è¯‘å¹¶æ‰“åŒ…,æµ‹è¯•æ²¡æœ‰é—®é¢˜åå†åˆ©ç”¨pacmanè¿›è¡Œå®‰è£….

### æºä»£ç è·å–å¹¶ä¿®æ”¹
å¦‚æœæ˜¯aurå®‰è£…çš„è¯,æºä»£ç ä¸€èˆ¬å·²ç»ä¸‹è½½åˆ°æœ¬åœ°äº†.å¯¹äºparuæ¥è¯´,ä¸‹è½½çš„ç¼–è¯‘è„šæœ¬æ˜¯åœ¨`$HOME/.cache/paru/clone/`ä¸‹,æˆ‘ä»¬è¿›å…¥onekoçš„åœ°å€,åº•ä¸‹åº”è¯¥æ˜¯ä¸€ä¸ªPKGBUILDæ–‡ä»¶å’Œæºç å‹ç¼©åŒ…,é¦–å…ˆ`makepkg -o`è¿›è¡Œè§£å‹,é»˜è®¤æƒ…å†µä¸‹,æºä»£ç ä¼šè§£å‹åˆ°srcæ–‡ä»¶å¤¹ä¸‹,è§‚å¯Ÿsrcä¸‹æœ‰ä¸€ä¸ª`oneko.h`å¤´æ–‡ä»¶,æ ¹æ®ç»éªŒæ¥çœ‹,è¿™ä¸ªæ–‡ä»¶é‡Œåº”è¯¥ä¼šæœ‰å›¾ç‰‡å°ºå¯¸ç­‰å‚æ•°,æœç„¶è®©æˆ‘æ‰¾åˆ°äº†ç±»ä¼¼çš„å®šä¹‰

```c
#define BITMAP_WIDTH        32

#define BITMAP_HEIGHT       32
```

å…ˆæŠŠå…¶ä¸­çš„32éƒ½æ”¹ä¸º50,ç„¶åå›åˆ°PKGBUILDæ‰€åœ¨ç›®å½•,è¿è¡Œ`makepkg -ef`è¿›è¡Œç¼–è¯‘,ç¡®å®å˜å¤§äº†,ä½†æ˜¯å›¾ç‰‡å‡ºå¤§é—®é¢˜äº†.

![image-20211110160219235](/img/oneko/image-20211110160219235.png)

è¿™ä¸€å¨æ˜¯å•¥ğŸ˜‚.. çœ‹æ¥å•çº¯çš„æ”¹å®šä¹‰æ˜¯ä¸è¡Œçš„,æˆ‘ä»¬è¿˜éœ€è¦ä¿®æ”¹å›¾ç‰‡çš„å°ºå¯¸. å›¾ç‰‡åœ¨`bitmap` å’Œ`bitmasks`ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢,éƒ½æ˜¯32x32çš„xbmæ ¼å¼å›¾ç‰‡,ç”¨vimæ‰“å¼€çš„è¯å¯ä»¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹,å…³äºxbmæ ¼å¼çš„è¯¦ç»†å†…å®¹å¯ä»¥å‚è€ƒ[è¿™ç¯‡æ–‡ç« ](https://zhuanlan.zhihu.com/p/358945096),å¤§è‡´ä¸Šä¸€ä¸ªåå…­è¿›åˆ¶å­—èŠ‚ä»£è¡¨ä¸€ä¸ª2x2çš„æ–¹æ ¼çš„æ’åˆ—æƒ…å†µ(2^4).

```c
#define up1_bsd_mask_width 32
#define up1_bsd_mask_height 32
static char up1_bsd_mask_bits[] = {
 0x00,0x06,0x30,0x00,0x00,0x07,0x70,0x00,0x80,0x03,0xe0,0x00,0xc0,0x03,0xe0,
 0x01,0xc0,0xfb,0xef,0x01,0xc0,0xff,0xff,0x01,0xc0,0xff,0xff,0x01,0xc0,0xff,
 0xff,0x01,0x80,0xff,0xff,0x00,0x80,0xff,0xff,0x00,0x00,0xff,0x7f,0x00,0x00,
 0xff,0x7f,0x00,0x00,0xff,0x7f,0x00,0x00,0xff,0x7f,0x00,0x00,0xfe,0x3f,0x00,
 0x00,0xfc,0x1f,0x00,0x00,0xfc,0x1f,0x00,0x00,0xfe,0x3f,0x00,0x00,0xff,0x7f,
 0x00,0x00,0xff,0x7f,0x00,0x80,0xff,0x7f,0x00,0x80,0xff,0xbf,0x00,0x80,0xff,
 0x3f,0x01,0x00,0xff,0x3f,0x02,0x00,0xfc,0x3f,0x00,0x00,0xfc,0x3f,0x00,0x00,
 0xf8,0x7f,0x00,0x00,0x40,0x7f,0x00,0x00,0x40,0x3e,0x00,0x00,0x28,0x00,0x00,
 0x00,0x18,0x00,0x00,0x00,0x38,0x00,0x00};
```

å¯ä»¥è‡ªå·±ç¼–å†™è„šæœ¬è¿›è¡Œç¼©æ”¾,ä¹Ÿå¯ä»¥åˆ©ç”¨GIMPç­‰å›¾ç‰‡è½¯ä»¶è¿›è¡Œç¼–è¾‘åè¦†ç›–,æˆ‘é€‰æ‹©åè€….é€‰æ‹©ç¼©æ”¾åˆ°50åƒç´ åè¦†ç›–åŸæ–‡ä»¶.

![image-20211110160754713](/img/oneko/image-20211110160754713.png)

### åˆ©ç”¨GIMPçš„BIMPæ’ä»¶è¿›è¡Œæ‰¹å¤„ç†

å¦ä¸€ä¸ªé—®é¢˜æ¥äº†,å›¾ç‰‡è¿™ä¹ˆå¤š,éš¾é“è¦æˆ‘ä»¬æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªçš„è¿›è¡Œä¿®æ”¹å—,ä¸€ç•ªæœç´¢åå‘ç°ä¸€ä¸ªå¾ˆä¸é”™çš„GIMPæ’ä»¶,[BIMP](https://alessandrofrancesconi.it/projects/bimp/),å¯ä»¥æ‰¹å¤„ç†ä¸€äº›ç®€å•çš„åŠ¨ä½œ,AURä¸Šä¹Ÿæœ‰è¿™ä¸ªåŒ…,å®‰è£…åå°±å¯ä»¥åœ¨æ–‡ä»¶é‚£ä¸€æ è¿è¡Œè¯¥æ’ä»¶.

![image-20211110161404357](/img/oneko/image-20211110161404357.png)

ç„¶åæŠŠå¯¼å‡ºçš„å›¾ç‰‡è¦†ç›–æ‰åŸæ¥çš„å›¾ç‰‡,ç»§ç»­ç¼–è¯‘,ä¸å‡ºæ„å¤–,ç¼–è¯‘æŠ¥é”™äº†..

![image-20211110161637885](/img/oneko/image-20211110161637885.png)

### è°ƒæ•´å¯¼å‡ºå›¾ç‰‡çš„æ ¼å¼

åˆ†æä¸€ä¸‹å¯¼å‡ºçš„å›¾ç‰‡,å‘ç°æ ¼å¼å®šä¹‰ä¸Šå’Œæºæ–‡ä»¶æœ‰å‡ºå…¥,ä¸¢å¤±äº†éƒ¨åˆ†å†…å®¹,è¿˜å¥½ä¸¢å¤±çš„éƒ¨åˆ†å†…å®¹å¯ä»¥ä»æ–‡ä»¶åä¸Šè·å¾—,ç¼–å†™ä¸€ä¸ªå°çš„fishè„šæœ¬åˆ©ç”¨sedæ¥å¤„ç†è¿™ä¸€æ­¥

```c
//å¯¼å‡ºåçš„æ ¼å¼
#define _width 50
#define _height 50
#define _x_hot 0
#define _y_hot 0
static unsigned char _bits[] = {.....};
___________________________________________
//æºæ–‡ä»¶å†…å®¹
#define up2_tomoyo_mask_width 32
#define up2_tomoyo_mask_height 32
static unsigned char up2_tomoyo_mask_bits[] = {......}
```

```shell
for i in (ls *.xbm)    >
    set filename (basename $i .xbm)
    sed -i "s/define\ _height/define\ $filename\_height/g" $i
    sed -i "s/define\ _width/define\ $filename\_width/g" $i
    sed -i '/_x_hot/d' $i
    sed -i '/_y_hot/d' $i
    sed -i "s/char\ _bits/char\ $filename\_bits/g" $i
end
```

æ¥ç€å†è¿›è¡Œç¼–è¯‘`makepkg -ef` å¹¶å®‰è£…`pacman -U xxxxx.zst`å°±å¯ä»¥å¼€å¿ƒçš„ç©è€å•¦.
