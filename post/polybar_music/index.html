<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>é€šè¿‡polybaræ§åˆ¶å¤šåª’ä½“ - ç”Ÿæ´»å’Œç¡è§‰.</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="with" /><meta name="description" content="è®°å½•ä¸€æ¬¡ç®€å•å®šåˆ¶åŒ–polybarçš„æŠ˜è…¾è®°å½•" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.111.3 with theme even" />


<link rel="canonical" href="https://with9.github.io/post/polybar_music/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="https://with9.github.io/sass/main.min.59fa635b67756aca024504fc61290d3c91e6332e773ecac116201a132e599ac0.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="é€šè¿‡polybaræ§åˆ¶å¤šåª’ä½“" />
<meta property="og:description" content="è®°å½•ä¸€æ¬¡ç®€å•å®šåˆ¶åŒ–polybarçš„æŠ˜è…¾è®°å½•" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://with9.github.io/post/polybar_music/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-12-20T00:00:00+00:00" />
<meta itemprop="name" content="é€šè¿‡polybaræ§åˆ¶å¤šåª’ä½“">
<meta itemprop="description" content="è®°å½•ä¸€æ¬¡ç®€å•å®šåˆ¶åŒ–polybarçš„æŠ˜è…¾è®°å½•"><meta itemprop="datePublished" content="2021-12-16T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-12-20T00:00:00+00:00" />
<meta itemprop="wordCount" content="1521">
<meta itemprop="keywords" content="guide,records," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="é€šè¿‡polybaræ§åˆ¶å¤šåª’ä½“"/>
<meta name="twitter:description" content="è®°å½•ä¸€æ¬¡ç®€å•å®šåˆ¶åŒ–polybarçš„æŠ˜è…¾è®°å½•"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">With&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/friends/">
        <li class="mobile-menu-item">Friends</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">With&#39;s Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/friends/">Friends</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">é€šè¿‡polybaræ§åˆ¶å¤šåª’ä½“</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-12-16 </span>
        <div class="post-category">
            <a href="/categories/it/"> IT </a>
            </div>
          <span class="more-meta"> 1521 words </span>
          <span class="more-meta"> 4 mins read </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> times read </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#polybarç®€å•ä»‹ç»">polybarç®€å•ä»‹ç»</a></li>
    <li><a href="#åˆæ­¥å°è¯•">åˆæ­¥å°è¯•</a></li>
    <li><a href="#ä»kde-connectå¾—åˆ°çš„çµæ„Ÿ">ä»KDE connectå¾—åˆ°çš„çµæ„Ÿ</a></li>
    <li><a href="#è¡¥å……">è¡¥å……</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
        <iframe style="max-width: 100%"
      class="music163"
      frameborder="no"
      border="0"
      marginwidth="0"
      marginheight="0"
      width="330"
      height="86"
      src="//music.163.com/outchain/player?type=2&id=28918133&auto=0&height=66">
    </iframe>
<h2 id="polybarç®€å•ä»‹ç»">polybarç®€å•ä»‹ç»</h2>
<p><a href="https://polybar.github.io/">polybar</a>æ˜¯ä¸€ä¸ªå¯ä»¥ç®€å•è¿›è¡Œè‡ªå®šä¹‰çš„çŠ¶æ€æ å·¥å…·,é€šè¿‡å„æ¨¡å—è¿›è¡Œç»„åˆ,å¯å®šåˆ¶æ€§éå¸¸å¼º.è¿™æ˜¯æˆ‘ä¸œæ‹¼è¥¿å‡‘çš„ä¸€ä¸ªæ ·å­ğŸ˜</p>
<p><img src="/img/polybar_music/Screenshot_20211216_205158.png" alt="Screenshot_20211216_205158"></p>
<p><img src="/img/polybar_music/image-20211216205419967.png" alt="image-20211216205419967"></p>
<p><a href="https://www.pixiv.net/artworks/89075761">æ¡Œé¢å£çº¸</a></p>
<p>ä»Šå¤©è¯»polybar wikiçš„æ—¶å€™,å‘ç°æœ‰ä¸€ä¸ªæ¨¡å—æ˜¯script,å¯ä»¥è‡ªå®šä¹‰å¹¶æ‰§è¡Œä¸€äº›è„šæœ¬,å¥½åƒå¾ˆå¥½ç©,å®˜æ–¹ä»“åº“ä¹Ÿæœ‰å¾ˆå¤šçš„<a href="https://github.com/polybar/polybar-scripts">ç”¨æˆ·è´¡çŒ®çš„scriptä¾‹å­</a>,å…¶ä¸­æœ‰å¾ˆå¤šæ˜¯å’ŒéŸ³ä¹æœ‰å…³çš„.</p>
<p><img src="/img/polybar_music/image-20211216205720202.png" alt="image-20211216205720202"></p>
<h2 id="åˆæ­¥å°è¯•">åˆæ­¥å°è¯•</h2>
<p>ä½†æ˜¯ä»¥spotifyä¸ºä¸»,å¯¹æˆ‘ç”¨å¤„ä¸æ˜¯å¾ˆå¤§,å°±æƒ³è‡ªå·±å†™ä¸€ä¸ªç”¨æ¥æ˜¾ç¤ºç½‘æ˜“äº‘æ­£åœ¨æ’­æ”¾çš„éŸ³ä¹çš„scriptæ¨¡å—,æˆ‘å‘ç°<code>wmctrl</code>å¯ä»¥è·å–åˆ°çª—å£çš„æ ‡é¢˜,è€Œç½‘æ˜“äº‘éŸ³ä¹çš„æ ‡é¢˜æ­£å¥½å°±æ˜¯å½“å‰æ’­æ”¾çš„æ›²ç›®.</p>
<p><img src="/img/polybar_music/image-20211216210039834.png" alt="image-20211216210039834"></p>
<p>é€šè¿‡<code>grep</code>æ˜¯æŠŠè¿™è¡Œè·å–åˆ°äº†,ä½†æ˜¯å‰é¢æœ‰å¾ˆå¤šæ— ç”¨ä¿¡æ¯,ä¸€å¼€å§‹å°è¯•<code>cut</code>,ä½†æ•ˆæœå¾ˆå¥‡æ€ª,ç½‘ä¸Šæœç´¢ä¸€ç•ª,æœ‰ä¸€ä¸ªå…³äºå¦‚ä½•ç”¨<code>wmctrl</code>è·å–æ ‡é¢˜çš„<a href="https://unix.stackexchange.com/questions/342404/getting-just-the-application-name-from-wmctrl-l">è®¨è®º</a>,å„ç§å¾ˆå¥‡æ€ªçš„æ–¹å¼ğŸ˜‚,ä¸ºä»€ä¹ˆ<code>wmctrl</code>ä¸å¯ä»¥æä¾›ä¸€ä¸ªæ ¼å¼åŒ–è¾“å‡ºçš„å‘½ä»¤å‘¢</p>
<p><img src="/img/polybar_music/image-20211216210814223.png" alt="image-20211216210814223"></p>
<p>ä¸€ç•ªå°è¯•å‘ç°è¿™æ¡å‘½ä»¤æ•ˆæœæœ€å¥½,copyè¿‡æ¥(</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">wmctrl -l <span class="p">|</span> sed <span class="s1">&#39;s/^[^ ]* *[^ ]* *[^ ]* //&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wmctrl -l <span class="p">|</span> sed <span class="s1">&#39;s/^[^ ]* *[^ ]* *[^ ]* //&#39;</span> <span class="p">|</span>grep <span class="s1">&#39;Cloud Music$&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ‹ãƒèŸ² - èŠ±ãŸã‚“ â€” Cloud Music <span class="c1">#æˆåŠŸè·å–æ ‡é¢˜å</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ä¸‹æ¥å°±æ˜¯ç®€å•çš„æ¨¡ä»¿scriptæ¨¡æ¿äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>module/mymusic<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">type</span><span class="o">=</span>custom/script
</span></span><span class="line"><span class="cl"><span class="nv">exec</span><span class="o">=</span>bash -c <span class="s2">&#34;wmctrl -l | sed &#39;s/^[^ ]* *[^ ]* *[^ ]* //&#39; |grep &#39;Cloud Music</span>$<span class="s2">&#39;|sed &#39;s/â€” Cloud Music//&#39;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">format</span> <span class="o">=</span> &lt;label&gt;
</span></span><span class="line"><span class="cl"><span class="nv">label</span> <span class="o">=</span> %output:0:40:...%
</span></span><span class="line"><span class="cl">format-foreground<span class="o">=</span> <span class="c1">#3399ff</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ•ˆæœè¿˜è¡Œ,å¯ä»¥æ˜¾ç¤ºæ’­æ”¾çš„æ›²ç›®,ä½†æ˜¯é™¤æ­¤ä¹‹å¤–å°±ä»€ä¹ˆéƒ½åšä¸äº†äº†(,å¯ä»¥åŠ ä¸Šç‚¹å‡»åŠ¨ä½œ,è·³è½¬åˆ°ç½‘æ˜“äº‘éŸ³ä¹çª—å£ä»€ä¹ˆçš„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">.........
</span></span><span class="line"><span class="cl">click-left<span class="o">=</span>i3-msg -t <span class="nb">command</span> <span class="o">[</span><span class="s1">&#39;class=netease-cloud-music&#39;</span><span class="o">]</span> focus
</span></span><span class="line"><span class="cl">click-right<span class="o">=</span>....
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä»kde-connectå¾—åˆ°çš„çµæ„Ÿ">ä»KDE connectå¾—åˆ°çš„çµæ„Ÿ</h2>
<p><a href="https://userbase.kde.org/KDEConnect/zh-hans">KDE connect</a>æ˜¯ä¸€ä¸ªå¯ä»¥å®ç°æ‰‹æœºå’Œç”µè„‘äº’ç›¸æ¥å—é€šçŸ¥çš„ä¸€ä¸ªKDEå·¥å…·,åªéœ€è¦åœ¨åº”ç”¨å•†åº—å®‰è£…å¥½å¹¶å’Œç”µè„‘è¿åœ¨åŒä¸€ä¸ªç½‘ç»œçš„æ—¶å€™å°±å¯ä»¥è¿›è¡Œæ¶ˆæ¯äº’é€š,æ–‡ä»¶å…±ä¼ ç­‰.è€Œä¸”æ‰‹æœºä¸Šè¿˜æœ‰ä¸ªå¤šåª’ä½“æ§åˆ¶,å¤§éƒ¨åˆ†æƒ…å†µä¸‹å¯ä»¥æ˜¾ç¤ºç°åœ¨æ­£åœ¨æ’­æ”¾çš„éŸ³ä¹,è¿›è¡Œä¸€äº›å¸¸è§„å¤šåª’ä½“æ“ä½œ,åŒ…æ‹¬åˆ‡æ­Œ,æš‚åœç­‰. <img src="/img/polybar_music/Screenshot_2021-12-16-21-20-34-120_org.kde.kdeconnect_tp.jpg" alt="Screenshot_2021-12-16-21-20-34-120_org.kde.kdeconnect_tp"></p>
<p>è€Œä¸”ä¸åªæ˜¯ä¸€ä¸¤ä¸ªç¨‹åº,å¾ˆå¤šçš„è½¯ä»¶æ’­æ”¾éŸ³ä¹,ç”šè‡³firefoxè§‚çœ‹è§†é¢‘,è¿™é‡Œéƒ½ä¼šæ˜¾ç¤ºå‡ºæ¥,è¯´æ˜èƒŒååº”è¯¥æœ‰ä¸€å¥—ç»Ÿä¸€çš„åè®®.é‚£æˆ‘ä»¬å¦‚æœäº†è§£kde connectæ˜¯å¦‚ä½•å·¥ä½œçš„,ä¸å°±å¯ä»¥æŠŠè¿™ä¸ªæ¨¡å—å®Œå–„çš„æ›´æ£’å—?</p>
<p>åˆæ˜¯ä¸€ç•ªæœç´¢,çœ‹åˆ°ubuntuè®ºå›çš„è¿™ä¸ª<a href="https://askubuntu.com/questions/1046143/media-players-kde-connect-multimedia-control">é—®é¢˜</a>,é¢˜ä¸»æœ¬æ„æ˜¯æƒ³çŸ¥é“å¦‚ä½•è®©mpvæ’­æ”¾çš„éŸ³ä¹è¢«kde connectè¯†åˆ«,ç¬¬ä¸€ä¸ªå›ç­”å°±å¾ˆæœ‰å¸®åŠ©</p>
<p><img src="/img/polybar_music/image-20211216212629748.png" alt="image-20211216212629748"></p>
<p>åŸæ¥åªè¦æ˜¯èµ°MPRISåè®®çš„ç¨‹åºå°±å¯ä»¥è¢«KDE connectè¯†åˆ«,<a href="https://specifications.freedesktop.org/mpris-spec/latest/">MPRIS</a>å¸Œæœ›æä¾›ä¸€å¥—ç»Ÿä¸€çš„APIæ¥å£æ¥ç®¡ç†æ‰€æœ‰çš„åª’ä½“æ’­æ”¾å™¨. <a href="https://wiki.archlinux.org/title/MPRIS">ArchlinuxWiki</a>ä¸Šä»‹ç»äº†ä¸€äº›ä¸MPRISè¿›è¡Œé€šè®¯çš„å·¥å…·,ä¸€çœ¼çœ‹ä¸­äº†<a href="https://github.com/altdesktop/playerctl">playerctrl</a>,ä¸»è¦æ„Ÿè§‰ä»–çš„æ“ä½œç®€å•ç›´æ¥.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">~âœ playerctl metadata --format <span class="s1">&#39;{{artist}}-{{title}}---{{album}}&#39;</span>
</span></span><span class="line"><span class="cl">è‘‰æœˆã‚†ã‚‰-å®µé—‡èŠ±ç«---å®µé—‡æ‹æƒ³å¥‡è­š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ä¸€æ¬¡åªä¼šæ˜¾ç¤ºä¸€ä¸ªç¨‹åº,é€šè¿‡-på‚æ•°å¯ä»¥æŒ‡å®šæ˜¾ç¤ºçš„ç¨‹åº</span>
</span></span><span class="line"><span class="cl">playerctl -p netease-cloud-music,mpv,%any metadata <span class="c1">#é¦–å…ˆé€‰æ‹©ç½‘æ˜“äº‘,æ²¡æœ‰å†é€‰æ‹©mpv,è¿˜æ˜¯æ²¡æœ‰å†é€‰æ‹©å…¶ä»–</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¯ä¸æ˜¯å‘½ä»¤éå¸¸ç®€å•ç›´æ¥,æ”¹è¿›ä¸€ä¸‹è¿™æ˜¯æœ€åçš„ç‰ˆæœ¬.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>module/mymusic<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">type</span><span class="o">=</span>custom/script
</span></span><span class="line"><span class="cl">exec-if<span class="o">=</span>playerctl status <span class="p">|</span>egrep <span class="s1">&#39;Playing|Paused&#39;</span> <span class="c1">#åˆ¤æ–­æœ‰æ²¡æœ‰åª’ä½“æ­£åœ¨æ’­æ”¾</span>
</span></span><span class="line"><span class="cl"><span class="nv">exec</span><span class="o">=</span>bash -c <span class="s2">&#34;playerctl -p netease-cloud-music,mpv,%any metadata --format &#39;{{artist}}-{{title}}--{{album}}&#39;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">format</span> <span class="o">=</span> ï€ &lt;label&gt;
</span></span><span class="line"><span class="cl"><span class="nv">label</span> <span class="o">=</span> %output:0:40:...%
</span></span><span class="line"><span class="cl">click-left<span class="o">=</span>i3-msg -t <span class="nb">command</span> workspace <span class="m">8</span>
</span></span><span class="line"><span class="cl">click-right<span class="o">=</span>playerctl -p netease-cloud-music,mpv,%any play-pause#å³é”®æš‚åœ
</span></span><span class="line"><span class="cl">scroll-up<span class="o">=</span>playerctl -p netease-cloud-music,mpv,%any previous#ä¸Šåˆ’ä¸Šä¸€é¦–
</span></span><span class="line"><span class="cl">scroll-down<span class="o">=</span>playerctl -p netease-cloud-music,mpv,%any next#ä¸‹æ»‘ä¸‹ä¸€é¦–
</span></span><span class="line"><span class="cl">format-foreground<span class="o">=</span> <span class="c1">#3399ff</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€åçš„æ•ˆæœæ˜¯è¿™æ ·çš„<img src="/img/polybar_music/image-20211216215156056.png" alt="image-20211216215156056"></p>
<h2 id="è¡¥å……">è¡¥å……</h2>
<p>ç”¨pythonè„šæœ¬å®ç°äº†ç‚¹å‡»è·³è½¬åˆ°æ’­æ”¾å·¥ä½œåŒºçš„åŠŸèƒ½,å¦‚æœå·²ç»åœ¨è¿™ä¸ªå·¥ä½œåŒºçš„æ—¶å€™å°±æ‰§è¡Œ<code>back_and_forth</code>è·³å›åˆ°ä¹‹å‰å·¥ä½œåŒº,<code>i3-msg -t get_tree</code>è¿”å›çš„æ•°æ®ç¡®å®æœ‰ç‚¹ä¹±&hellip;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/python</span>
</span></span><span class="line"><span class="cl"><span class="c1">#author :  with &lt;dc198424601@outlook.com&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_windows</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#è·å¾—ä¸€ä¸ªå­—å…¸,é”®æ˜¯å·¥ä½œåŒºåå­—,å€¼æ˜¯ä¸€ä¸ªåˆ—è¡¨,é‡Œé¢æ˜¯ç¨‹åºçš„classname</span>
</span></span><span class="line"><span class="cl">    <span class="n">classPattern</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&#34;class&#39;: &#39;(.*?)&#39;,&#34;</span><span class="p">)</span><span class="c1">#è·å–classåç§°çš„æ­£åˆ™</span>
</span></span><span class="line"><span class="cl">    <span class="n">tree_dict</span><span class="o">=</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s1">&#39;i3-msg -t get_tree&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">treeData</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">workspace</span> <span class="ow">in</span> <span class="n">treeData</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">tree_dict</span><span class="p">[</span><span class="n">workspace</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="n">windows</span><span class="o">=</span><span class="n">classPattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">workspace</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">tree_dict</span><span class="p">[</span><span class="n">workspace</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">tree_dict</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_current_workspace</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#è¿”å›å½“å‰å·¥ä½œåŒºçš„åå­—</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s1">&#39;i3-msg -t get_workspaces&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">treeData</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">treeData</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;focused&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">current_player</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s2">&#34;playerctl -p netease-cloud-music,mpv,</span><span class="si">%a</span><span class="s2">ny metadata|cut -d&#39; &#39; -f1|uniq&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">current_player</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">get_windows</span><span class="p">()[</span><span class="n">get_current_workspace</span><span class="p">()]):</span>
</span></span><span class="line"><span class="cl">        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;i3-msg -t command [class=</span><span class="si">{}</span><span class="s2">] focus&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">current_player</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;i3-msg -t command workspace back_and_forth&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p>å‚è€ƒé“¾æ¥</p>
<p>[1]:<a href="https://polybar.github.io">https://polybar.github.io/</a></p>
<p>[2]:<a href="https://www.pixiv.net/artworks/89075761">https://www.pixiv.net/artworks/89075761</a></p>
<p>[3]:<a href="https://github.com/polybar/polybar-scripts">https://github.com/polybar/polybar-scripts</a></p>
<p>[4]:<a href="https://unix.stackexchange.com/questions/342404/getting-just-the-application-name-from-wmctrl-l">https://unix.stackexchange.com/questions/342404/getting-just-the-application-name-from-wmctrl-l</a></p>
<p>[5]:<a href="https://userbase.kde.org/KDEConnect/zh-hans">https://userbase.kde.org/KDEConnect/zh-hans</a></p>
<p>[6]:<a href="https://askubuntu.com/questions/1046143/media-players-kde-connect-multimedia-control">https://askubuntu.com/questions/1046143/media-players-kde-connect-multimedia-control</a></p>
<p>[7]:<a href="https://specifications.freedesktop.org/mpris-spec/latest/">https://specifications.freedesktop.org/mpris-spec/latest/</a></p>
<p>[8]:<a href="https://wiki.archlinux.org/title/MPRIS">https://wiki.archlinux.org/title/MPRIS</a></p>
<p>[9]:<a href="https://github.com/altdesktop/playerctl">https://github.com/altdesktop/playerctl</a></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">with</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2021-12-20
        
    </span>
  </p>
  <p class="copyright-item">
      <span class="item-title">Markdown</span>
      <span class="item-content"><a class="link-to-markdown" href="https://with9.github.io/post/polybar_music/index.md" target="_blank">The Markdown version Â»</a></span>
    </p>
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/guide/">guide</a>
          <a href="/tags/records/">records</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/kiritan/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Aiæ­Œå§¬ä¸œåŒ—åˆ‡è’²è‹±~</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/oneko/">
            <span class="next-text nav-default">oneko ä¸€ä¸ªå°æ¡Œå® çš„æŠ˜è…¾è®°å½•</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitalk = new Gitalk({
        id: '2021-12-16 00:00:00 \u002b0000 UTC',
        title: 'é€šè¿‡polybaræ§åˆ¶å¤šåª’ä½“',
        clientID: '27bf7867e6bf8c9bd64d',
        clientSecret: '9892a31bd3d6e5ca6e0f255ae3c4b2c761b33595',
        repo: 'with9.github.io',
        owner: 'with9',
        admin: ['with9'],
        body: decodeURI(location.href)
      });
      gitalk.render('gitalk-container');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/gitalk/gitalk">comments powered by gitalk.</a></noscript>

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:dc198424601@outlook.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/with9" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/u/2582158737" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/people/yu-yuan-86-34" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://space.bilibili.com/9063101" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://with9.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> site pv: <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> site uv: <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2020 - 
    2023
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">with</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="https://with9.github.io/js/main.4d21c1cefdf1cd0b77ef59bab2d1bbe3112fc9d6cc04710bb1f0b1fd7b891f11.js"></script>








</body>
</html>
